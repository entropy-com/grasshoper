Object.defineProperty(exports,"__esModule",{value:!0});var e=require("tiny-lru");function t(e,t,n,r,u,i,o){try{var l=e[i](o),c=l.value}catch(e){n(e);return}l.done?t(c):Promise.resolve(c).then(r,u)}function n(e){return function(){var n=this,r=arguments;return new Promise(function(u,i){var o=e.apply(n,r);function l(e){t(o,u,i,l,c,"next",e)}function c(e){t(o,u,i,l,c,"throw",e)}l(void 0)})}}exports.default=function(t={}){let{enableCache:r,defaultCache:u=e.lru(100,3e5)}=t;return function(e){return n(function*(t){let{enableCache:i=r,forceUpdate:o,defaultCache:l=u,_url:c,encode:f,data:a}=t,d="GET"===t.method||t.isGet,s=typeof i;if("undefined"===s?d:"function"===s?i(t):!!i){let r=function(e,t,n){let r=t?n(t):"";r&&(r=e.includes("?")?e+"&"+r:e+"?"+r);let[u,i]=r.split("?");if(i){let e=i.split("&");return`${u}?${e.sort().join("&")}`}return r||e}(c,a,f),u=l.get(r);return!u||o?(u=n(function*(){try{return yield e(t)}catch(e){throw"delete"in l?l.delete(r):l.del(r),e}})(),l.set(r,u),u):u.then(e=>(e.fromCache=!0,e))}return e(t)})}};
